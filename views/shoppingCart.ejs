<%- include('./partials/top') %>
<div class="container">
  <!--#####################START HERE######################-->

  <!-- JUMBOTRON -->
  <div class="jumbotron">
    <h1 class="display-4">Stanly Kwok</h1>
    <p class="lead">43 Anzac Avenue</p>
    <p>555-555-5555</p>
  </div>

  <table class="table text-center">
    <thead class="bg-primary text-light">
        <tr>
            <th>#</th>
            <th>Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Total Price</th>
        </tr>
    </thead>
    <tbody>
      <% if (products2) { %>
        <% products1.forEach(product1 => { %>
        <% products2.forEach((product2, index) => { %>
         <% if (product1.id == product2.productId) { %> 
        <tr>
          <td><%= index + 1 %></td>
          <td><%= product1.name %></td>
          <td><%= formatPrice(product1.price) %></td>
          <td><%= product2.quantityBought %></td>
          <td class="price"><%= formatPrice(product2.quantityBought * product1.price) %></td>
        </tr>
        <% } %>
        <% }) %>
        <% }) %>
        <% } %>
        <tr>
          <td class="bg-warning" colspan="4">&nbsp;</td>
          <% if (products2) { %>
          <td class="bg-secondary text-light" class="totalPrice"><%= price %></td>
          <% } %>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td class="bg-secondary">
            <button class="btn btn-danger mr-3">Drop cart</button>
            <button class="btn btn-success">Buy now!</button>
          </td>
        </tr>
    </tbody>
</table>

</div>
<script defer>
  let totalPrice = document.querySelector('.totalPrice');
  let allPrices = document.querySelectorAll('.price');
  let sum = 0;
  allPrices.forEach(price => {
    sum += Number(price.textContent);
  });
  totalPrice.textContent = sum;
</script>
<%- include('./partials/bottom.ejs') %>